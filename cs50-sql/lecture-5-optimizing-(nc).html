<!DOCTYPE html> <html><head>
		<title>Lecture 5 - Optimizing (NC)</title>
		<base href="../">
		<meta id="root-path" root-path="../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Congzhi's Notes Vault - Lecture 5 - Optimizing (NC)">
		<meta property="og:title" content="Lecture 5 - Optimizing (NC)">
		<meta property="og:description" content="Congzhi's Notes Vault - Lecture 5 - Optimizing (NC)">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://congzhi.wiki/cs50-sql/lecture-5-optimizing-(nc).html">
		<meta property="og:image" content="https://cs50.harvard.edu/sql/2024/notes/5/images/3.jpg">
		<meta property="og:site_name" content="Congzhi's Notes Vault">
		<meta name="author" content="Congzhi"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://congzhi.wiki/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-c.mjx-c1D442.TEX-I::before{padding:.704em .763em .022em 0;content:"O"}mjx-c.mjx-c1D459.TEX-I::before{padding:.694em .298em .011em 0;content:"l"}mjx-c.mjx-c1D45C.TEX-I::before{padding:.441em .485em .011em 0;content:"o"}mjx-c.mjx-c1D454.TEX-I::before{padding:.442em .477em .205em 0;content:"g"}mjx-c.mjx-c4B::before{padding:.683em .778em 0 0;content:"K"}mjx-c.mjx-c46::before{padding:.68em .653em 0 0;content:"F"}mjx-c.mjx-c7A::before{padding:.431em .444em 0 0;content:"z"}mjx-c.mjx-cD7::before{padding:.491em .778em 0 0;content:"×"}mjx-msup{display:inline-block;text-align:left}mjx-c.mjx-c4D::before{padding:.683em .917em 0 0;content:"M"}mjx-c.mjx-c79::before{padding:.431em .528em .204em 0;content:"y"}mjx-c.mjx-c42::before{padding:.683em .708em 0 0;content:"B"}mjx-c.mjx-c73::before{padding:.448em .394em .011em 0;content:"s"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c1D43A.TEX-I::before{padding:.705em .786em .022em 0;content:"G"}mjx-c.mjx-c1D43E.TEX-I::before{padding:.683em .889em 0 0;content:"K"}mjx-c.mjx-c47::before{padding:.705em .785em .022em 0;content:"G"}mjx-c.mjx-c70::before{padding:.442em .556em .194em 0;content:"p"}mjx-c.mjx-c2217::before{padding:.465em .5em 0 0;content:"∗"}mjx-c.mjx-c35::before{padding:.666em .5em .022em 0;content:"5"}mjx-c.mjx-c1D45A.TEX-I::before{padding:.442em .878em .011em 0;content:"m"}mjx-c.mjx-c1D45F.TEX-I::before{padding:.442em .451em .011em 0;content:"r"}mjx-c.mjx-c1D460.TEX-I::before{padding:.442em .469em .01em 0;content:"s"}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c1D457.TEX-I::before{padding:.661em .412em .204em 0;content:"j"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-c.mjx-c1D435.TEX-I::before{padding:.683em .759em 0 0;content:"B"}mjx-c.mjx-c1D441.TEX-I::before{padding:.683em .888em 0 0;content:"N"}mjx-mtext{display:inline-block;text-align:left}mjx-c.mjx-c44::before{padding:.683em .764em 0 0;content:"D"}mjx-c.mjx-c65::before{padding:.448em .444em .011em 0;content:"e"}mjx-c.mjx-c61::before{padding:.448em .5em .011em 0;content:"a"}mjx-c.mjx-c64::before{padding:.694em .556em .011em 0;content:"d"}mjx-c.mjx-c6C::before{padding:.694em .278em 0 0;content:"l"}mjx-c.mjx-c69::before{padding:.669em .278em 0 0;content:"i"}mjx-c.mjx-c6E::before{padding:.442em .556em 0 0;content:"n"}mjx-c.mjx-c20::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c54::before{padding:.677em .722em 0 0;content:"T"}mjx-c.mjx-c6D::before{padding:.442em .833em 0 0;content:"m"}mjx-c.mjx-c2D::before{padding:.252em .333em 0 0;content:"-"}mjx-c.mjx-c43::before{padding:.705em .722em .021em 0;content:"C"}mjx-c.mjx-c75::before{padding:.442em .556em .011em 0;content:"u"}mjx-c.mjx-c72::before{padding:.442em .392em 0 0;content:"r"}mjx-c.mjx-c74::before{padding:.615em .389em .01em 0;content:"t"}mjx-c.mjx-c53::before{padding:.705em .556em .022em 0;content:"S"}mjx-c.mjx-c63::before{padding:.448em .444em .011em 0;content:"c"}mjx-c.mjx-c6B::before{padding:.694em .528em 0 0;content:"k"}mjx-c.mjx-c52::before{padding:.683em .736em .022em 0;content:"R"}mjx-c.mjx-c67::before{padding:.453em .5em .206em 0;content:"g"}mjx-c.mjx-c45::before{padding:.68em .681em 0 0;content:"E"}mjx-c.mjx-c78::before{padding:.431em .528em 0 0;content:"x"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c220F.TEX-S2::before{padding:.95em 1.278em .45em 0;content:"∏"}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c2264::before{padding:.636em .778em .138em 0;content:"≤"}mjx-munderover{display:inline-block;text-align:left}mjx-munderover:not([limits=false]){padding-top:.1em}mjx-munderover:not([limits=false])>*{display:block}mjx-msubsup{display:inline-block;text-align:left}mjx-script{display:inline-block;padding-right:.05em;padding-left:.033em}mjx-script>mjx-spacer{display:block}mjx-c.mjx-c1D70F.TEX-I::before{padding:.431em .517em .013em 0;content:"τ"}mjx-c.mjx-c1D458.TEX-I::before{padding:.694em .521em .011em 0;content:"k"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c1D448.TEX-I::before{padding:.683em .767em .022em 0;content:"U"}mjx-c.mjx-c2211.TEX-S2::before{padding:.95em 1.444em .45em 0;content:"∑"}mjx-c.mjx-c3C::before{padding:.54em .778em .04em 0;content:"<"}mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mfrac{display:inline-block;text-align:left}mjx-frac{display:inline-block;vertical-align:.17em;padding:0 .22em}mjx-frac[type="d"]{vertical-align:.04em}mjx-frac[delims]{padding:0 .1em}mjx-frac[atop]{padding:0 .12em}mjx-frac[atop][delims]{padding:0}mjx-dtable{display:inline-table;width:100%}mjx-dtable>*{font-size:2000%}mjx-dbox{display:block;font-size:5%}mjx-num{display:block;text-align:center}mjx-den{display:block;text-align:center}mjx-mfrac[bevelled]>mjx-num{display:inline-block}mjx-mfrac[bevelled]>mjx-den{display:inline-block}mjx-den[align=right],mjx-num[align=right]{text-align:right}mjx-den[align=left],mjx-num[align=left]{text-align:left}mjx-nstrut{display:inline-block;height:.054em;width:0;vertical-align:-.054em}mjx-nstrut[type="d"]{height:.217em;vertical-align:-.217em}mjx-dstrut{display:inline-block;height:.505em;width:0}mjx-dstrut[type="d"]{height:.726em}mjx-line{display:block;box-sizing:border-box;min-height:1px;height:.06em;border-top:.06em solid;margin:.06em -.1em;overflow:hidden}mjx-line[type="d"]{margin:.18em -.1em}mjx-mrow{display:inline-block;text-align:left}mjx-mn{display:inline-block;text-align:left}mjx-msub{display:inline-block;text-align:left}mjx-texatom{display:inline-block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c1D445.TEX-I::before{padding:.683em .759em .021em 0;content:"R"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c1D44A.TEX-I::before{padding:.683em 1.048em .022em 0;content:"W"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c1D446.TEX-I::before{padding:.705em .645em .022em 0;content:"S"}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c1D444.TEX-I::before{padding:.704em .791em .194em 0;content:"Q"}mjx-c.mjx-c3E::before{padding:.54em .778em .04em 0;content:">"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c33::before{padding:.665em .5em .022em 0;content:"3"}</style><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> SQL</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="<a data-tooltip-position=&quot;top&quot; aria-label=&quot;https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5&quot; rel=&quot;noopener nofollow&quot; class=&quot;external-link&quot; href=&quot;https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5&quot; target=&quot;_blank&quot;>Lecture 5</a>"><p dir="auto"><a href="https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5" class="external-link" rel="noopener nofollow" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5" data-tooltip-position="top" target="_blank">Lecture 5</a></p></h1><div class="el-h1 heading-wrapper"><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" target="_blank">Introduction</a></li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index" target="_blank">Index</a>
<ul>
<li data-line="2" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions" target="_blank">Questions</a></li>
</ul>
</li>
<li data-line="3" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" target="_blank">Index across Multiple Tables</a></li>
<li data-line="4" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" target="_blank">Space Trade-off</a></li>
<li data-line="5" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" target="_blank">Time Trade-off</a>1</li>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" target="_blank">Partial Index</a>
<ul>
<li data-line="7" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" target="_blank">Questions</a>cg怒于n、</li>
</ul>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" target="_blank">Vacuum</a>
<ul>
<li data-line="9" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" target="_blank">Questions</a></li>
</ul>
</li>
<li data-line="10" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" target="_blank">Concurrency</a>
<ul>
<li data-line="11" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" target="_blank">Transactions</a></li>
<li data-line="12" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" target="_blank">Race Conditions</a></li>
<li data-line="13" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" target="_blank">Questions</a></li>
</ul>
</li>
<li data-line="14" dir="auto"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#fin" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#fin" target="_blank">Fin</a>j</li>
</ul></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Introduction](https://cs50.harvard.edu/sql/2024/notes/5/#introduction)" dir="auto" class="heading" id="[Introduction](https://cs50.harvard.edu/sql/2024/notes/5/#introduction)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" target="_blank">Introduction</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">This week, we will learn how to optimize our SQL queries, both for time and space. We will also learn how to run queries concurrently.</li>
<li data-line="1" dir="auto">We will do all of this in the context of a new database — the Internet Movies Database, or IMDb as it is more popularly known. Our SQLite database is compiled from the large online database of movies you may have seen before at&nbsp;<a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/imdb.com" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/imdb.com" target="_blank">imdb.com</a>.</li>
<li data-line="2" dir="auto">Take a look at these statistics to get a sense of how big this database is! It has much more data than any of the other databases we have worked with so far.
  <img alt="&quot;Statistics about the IMDb database&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/3.jpg" referrerpolicy="no-referrer"><br>
</li>
<li data-line="6" dir="auto">Here is the ER Diagram detailing the entities and their relationships.
  <img alt="&quot;IMDb ER Diagram — people, movies, and ratings entities&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/4.jpg" referrerpolicy="no-referrer"><br>
</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Index](https://cs50.harvard.edu/sql/2024/notes/5/#index)" dir="auto" class="heading" id="[Index](https://cs50.harvard.edu/sql/2024/notes/5/#index)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index" target="_blank">Index</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Let us open up this database called&nbsp;<code>movies.db</code>&nbsp;in SQLite.</li>
<li data-line="1" dir="auto"><code>.schema</code>&nbsp;shows us the tables created in this database. To implement the many-to-many relationship between the entities Person and Movie from the ER Diagram, we have a joint table here called&nbsp;<code>stars</code>&nbsp;that references the ID columns of both&nbsp;<code>people</code>&nbsp;and&nbsp;<code>movies</code>&nbsp;as foreign key columns!</li>
<li data-line="2" dir="auto">To peek into the&nbsp;<code>movies</code>&nbsp;table, we can select from the table and limit results.
<pre><code data-line="4">SELECT * FROM "movies" LIMIT 5;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>To find the information pertaining to the movie Cars, we would run the following query.
<pre><code data-line="10">SELECT * FROM "movies"
WHERE "title" = 'Cars';
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<ul>
<li data-line="15" dir="auto">Say we want to find how long it took for this query to run. SQLite has a command&nbsp;<code>.timer on</code>&nbsp;that enables us to time our queries.</li>
<li data-line="16" dir="auto">On running the above query to find Cars again, we can see three different time measurements displayed along with the results.</li>
<li data-line="17" dir="auto">“real” time indicates the stopwatch time, or the time between executing the query and obtaining the results. This is the measure of time we will focus on. The time taken to execute this query during lecture was roughly a tenth of a second!</li>
</ul>
</li>
<li data-line="18" dir="auto">Under the hood, when the query to find Cars was run, we triggered a&nbsp;<strong>scan</strong>&nbsp;of the table&nbsp;<code>movies</code>&nbsp;— that is, the table&nbsp;<code>movies</code>&nbsp;was scanned top to bottom, one row at a time, to find all the rows with the title Cars.</li>
<li data-line="19" dir="auto">We can optimize this query to be more efficient than a scan. In the same way that textbooks often have an index, databases tables can have an index as well. An index, in database terminology, is a structure used to speed up the retrieval of rows from a table.</li>
<li data-line="20" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>We can use the following command to create an index for the&nbsp;<code>"title"</code>&nbsp;column in the&nbsp;<code>movies</code>&nbsp;table.
<pre><code data-line="22">CREATE INDEX "title_index" ON "movies" ("title");
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<ul>
<li data-line="26" dir="auto">After creating this index, we run the query to find the movie titled Cars again. On this run, the time taken is significantly shorter (during lecture,almost eight times faster than the first run)!</li>
</ul>
</li>
<li data-line="27" dir="auto">In the previous example, once the index was created, we just assumed that SQL would use it to find a movie. However, we can also explicitly see this by using a SQLite command&nbsp;<code>EXPLAIN QUERY PLAN</code>&nbsp;before any query.</li>
<li data-line="28" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>To remove the index we just created, run:
<pre><code data-line="30">DROP INDEX "title_index";
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<ul>
<li data-line="34" dir="auto">After dropping the index, running&nbsp;<code>EXPLAIN QUERY PLAN</code>&nbsp;again with the&nbsp;<code>SELECT</code>&nbsp;query will demonstrate that the plan would revert to scanning the entire database.</li>
</ul>
</li>
</ul></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions)" dir="auto" class="heading" id="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions" target="_blank">Questions</a></h3><div class="heading-children"><div class="el-blockquote"><blockquote dir="auto">
<p>Do databases not have implicit algorithms to optimize searching?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">They do, for some columns. In SQLite and most other database management systems, if we specify that a column is a primary key, an index will automatically be created via which we can search for the primary key. However, for regular columns like&nbsp;<code>"title"</code>, there would be no automatic optimization.</li>
</ul></div><div class="el-blockquote"><blockquote dir="auto">
<p>Would it be advisable to create a different index for every column in case we need it?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">While that seems useful, there are trade-offs with space and the time it takes to later insert data into tables with an index. We will see more on this shortly!</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Index across Multiple Tables](https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables)" dir="auto" class="heading" id="[Index_across_Multiple_Tables](https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" target="_blank">Index across Multiple Tables</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">We would run the following query to find all the movies Tom Hanks starred in.
<pre><code data-line="2">SELECT "title" FROM "movies"
WHERE "id" IN (
    SELECT "movie_id" FROM "stars"
    WHERE "person_id" = (
        SELECT "id" FROM "people"
        WHERE "name" = 'Tom Hanks'
    )
);
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="13" dir="auto">To understand what kind of index could help speed this query up, we can run&nbsp;<code>EXPLAIN QUERY PLAN</code>&nbsp;ahead of this query again. This shows us that the query requires two scans — of&nbsp;<code>people</code>&nbsp;and&nbsp;<code>stars</code>. The table&nbsp;<code>movies</code>&nbsp;is not scanned because we are searching&nbsp;<code>movies</code>&nbsp;by its ID, for which an index is automatically created by SQLite!</li>
<li data-line="14" dir="auto">Let us create the two indexes to speed this query up.
<pre><code data-line="16">CREATE INDEX "person_index" ON "stars" ("person_id");
CREATE INDEX "name_index" ON "people" ("name");
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="21" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now, we run&nbsp;<code>EXPLAIN QUERY PLAN</code>&nbsp;with the same nested query. We can observe that
<ul>
<li data-line="22" dir="auto">all the scans are now searches using indexes, which is great!</li>
<li data-line="23" dir="auto">the search on the table&nbsp;<code>people</code>&nbsp;uses something called a&nbsp;<code>COVERING INDEX</code></li>
</ul>
</li>
<li data-line="24" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>A covering index means that all the information needed for the query can be found within the index itself. Instead of two steps:
<ol>
<li data-line="25" dir="auto">looking up relevant information in the index,</li>
<li data-line="26" dir="auto">using the index to then search the table, a covering index means that we do our search in one step (just the first one).</li>
</ol>
</li>
<li data-line="27" dir="auto">To have our search on the table&nbsp;<code>stars</code>&nbsp;also use a covering index, we can add&nbsp;<code>"movie_id"</code>&nbsp;to the index we created for&nbsp;<code>stars</code>. This will ensure that the information being looked up (movie ID)&nbsp;<em>and</em>&nbsp;the value being searched on (person ID) are both be in the index.</li>
<li data-line="28" dir="auto">First, let us drop the existing implementation of our index on the&nbsp;<code>stars</code>&nbsp;table.
<pre><code data-line="30">DROP INDEX "person_index";
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="34" dir="auto">Next, we create the new index.
<pre><code data-line="36">CREATE INDEX "person_index" ON "stars" ("person_id", "movie_id");
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="40" dir="auto">Running the following will demonstrate that we now have two covering indexes, which should result in a much faster search!
<pre><code data-line="42">EXPLAIN QUERY PLAN
SELECT "title" FROM "movies" WHERE "id" IN (
    SELECT "movie_id" FROM "stars" WHERE "person_id" = (
        SELECT "id" FROM "people" WHERE "name" = 'Tom Hanks'
    )
);
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="51" dir="auto">Making sure that we have run&nbsp;<code>.timer on</code>&nbsp;let us execute the above query to find all the movies Tom Hanks has starred in, and observe the time it takes to run. The query now runs a&nbsp;<em>lot</em>&nbsp;faster than it did without indexes (in lecture, an order of magnitude faster)!</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Space Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off)" dir="auto" class="heading" id="[Space_Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" target="_blank">Space Trade-off</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Indexes seem incredibly helpful, but there are trade-offs associated — they occupy additional space in the database, so while we gain query speed, we do lose space.</li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>An index is stored in a database as a data structure called a B-Tree, or balanced tree. A tree data structure looks something like:
  <img alt="&quot;Tree data structure&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/20.jpg" referrerpolicy="no-referrer">
<ul>
<li data-line="5" dir="auto">Notice that the tree has many&nbsp;<strong>nodes</strong>, each connected to a few others by arrows. The root node, or the node from which the tree originates, has three&nbsp;<strong>children</strong>. Some nodes at the edge of the tree do not point to any other nodes. These are called&nbsp;<strong>leaf</strong>&nbsp;nodes.</li>
</ul>
</li>
<li data-line="6" dir="auto">Let us consider how an index is created for the&nbsp;<code>"title"</code>&nbsp;column of the table&nbsp;<code>movies</code>. If the movie titles were sorted alphabetically, it would be a lot easier to find a particular movie by using&nbsp;<a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Binary_search_algorithm" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Binary_search_algorithm" target="_blank">binary search</a>.</li>
<li data-line="7" dir="auto">In this case, a copy is made of the&nbsp;<code>"titles"</code>&nbsp;column. This copy is sorted and then linked back to the original rows within the&nbsp;<code>movies</code>&nbsp;table by pointing to the movie IDs. This is visualized below.
  <img alt="&quot;Index: Sorted copy of titles pointing to original movie IDs&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/40.jpg" referrerpolicy="no-referrer"><br>
</li>
<li data-line="11" dir="auto">While this helps us visualize the index for this column easily, in reality, the index is not a single column but is broken up into many nodes. This is because if the database has a lot of data, like our IMDb example, storing one column all together in memory might not be feasible.</li>
<li data-line="12" dir="auto">If we have multiple nodes containing sections of the index, however, we also need nodes to navigate to the right sections. For example, consider the following nodes. The left-hand node directs us to the right section of the index based on whether the movie title comes before Frozen, between Frozen and Soul, or after Soul alphabetically!
  <img alt="&quot;Index nodes broken into sections&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/46.jpg" referrerpolicy="no-referrer"><br>
</li>
<li data-line="16" dir="auto">The above representation is a B-tree! This is how indexes are stored in SQLite.</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Time Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off)" dir="auto" class="heading" id="[Time_Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" target="_blank">Time Trade-off</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Similar to the space trade-off we discussed earlier, it also takes longer to insert data into a column and then add it to an index. Each time a value is added to the index, the B-tree needs to be traversed to figure out where the value should be added!</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Partial Index](https://cs50.harvard.edu/sql/2024/notes/5/#partial-index)" dir="auto" class="heading" id="[Partial_Index](https://cs50.harvard.edu/sql/2024/notes/5/#partial-index)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" target="_blank">Partial Index</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">This is an index that includes only a subset of rows from a table, allowing us to save some space that a full index would occupy.</li>
<li data-line="1" dir="auto">This is especially useful when we know that users query only a subset of rows from the table. In the case of IMDb, it may be that the users are more likely to query a movie that was just released as opposed to a movie that is 15 years old. Let’s try to create a partial index that stores the titles of movies released in 2023.
<pre><code data-line="3">CREATE INDEX "recents" ON "movies" ("titles")
WHERE "year" = 2023;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="8" dir="auto">We can check that searching for movies released in 2023 uses the new index.
<pre><code data-line="10">EXPLAIN QUERY PLAN
SELECT "title" FROM "movies"
WHERE "year" = 2023;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
  This shows us that the&nbsp;<code>movies</code>&nbsp;table is scanned using the partial index.<br>
</li>
</ul></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-1)" dir="auto" class="heading" id="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-1)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" target="_blank">Questions</a></h3><div class="heading-children"><div class="el-blockquote"><blockquote dir="auto">
<p>Are indexes saved in the schema?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Yes, in SQLite, they are! We can confirm this by running&nbsp;<code>.schema</code>&nbsp;and we will see the indexes created listed in the database schema.</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Vacuum](https://cs50.harvard.edu/sql/2024/notes/5/#vacuum)" dir="auto" class="heading" id="[Vacuum](https://cs50.harvard.edu/sql/2024/notes/5/#vacuum)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" target="_blank">Vacuum</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">There are ways to delete unused space in our database. SQLite allows us to “vacuum” data — this cleans up previously deleted data (that is actually not deleted, but just marked as space being available for the next&nbsp;<code>INSERT</code>).</li>
<li data-line="1" dir="auto">To find the size of&nbsp;<code>movies.db</code>&nbsp;on the terminal, we can use a Unix command
<pre><code data-line="3">du -b movies.db
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="7" dir="auto">In lecture, this command showed us that the size of the database is something like 158 million bytes, or 158 megabytes.</li>
<li data-line="8" dir="auto">We can now connect to our database and drop an index we previously created.
<pre><code data-line="10">DROP INDEX "person_index";
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="14" dir="auto">Now, if we run the Unix command again, we see that the size of the database has not decreased! To actually clean up the deleted space, we need to vacuum it. We can run the following command in SQLite.
<pre><code data-line="16">VACUUM;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
  This might take a second or two to run. On running the Unix command to check the size of the database again, we can should see a smaller size. Once we drop all the indexes and vacuum again, the database will be considerably smaller than 158 MB (in lecture, around 100 MB).<br>
</li>
</ul></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-2)" dir="auto" class="heading" id="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-2)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" target="_blank">Questions</a></h3><div class="heading-children"><div class="el-blockquote"><blockquote dir="auto">
<p>Is it possible to vacuum faster?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Each vacuum can take a different amount of time, depending on the amount of space we are trying to vacuum and how easy it is to find the bits and bytes that need to be freed up!</li>
</ul></div><div class="el-blockquote"><blockquote dir="auto">
<p>If a query to delete some rows doesn’t actually delete them, but only marks them as deleted, could we still retrieve these rows?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">People trained in forensics are able to find data we think is deleted but is actually still on our computers. In the case of SQLite, after performing a vacuum, it would not be possible to find deleted rows again.</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Concurrency](https://cs50.harvard.edu/sql/2024/notes/5/#concurrency)" dir="auto" class="heading" id="[Concurrency](https://cs50.harvard.edu/sql/2024/notes/5/#concurrency)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" target="_blank">Concurrency</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Thus far, we have seen how to optimize single queries. Now, we will look at how to allow not just one query, but multiple at a time.</li>
<li data-line="1" dir="auto">Concurrency is the simultaneous handling of multiple queries or interactions by the database. Imagine a database for a website, or a financial service, that gets a lot of traffic at the same time. Concurrency is particularly important in these cases.</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Some database transactions can be multi-part. For example, consider a bank’s database. The following is a view of the table&nbsp;<code>accounts</code>&nbsp;that stores account balances.
  <img alt="&quot;Accounts table in a bank's database. Alice sends $10 to Bob.&quot;" src="https://cs50.harvard.edu/sql/2024/notes/5/images/66.jpg" referrerpolicy="no-referrer">
<ul>
<li data-line="6" dir="auto">One transaction could be sending money from one account to the other. For example, Alice is trying to send $10 to Bob.</li>
<li data-line="7" dir="auto">To complete this transaction, we would need to add $10 to Bob’s account and also subtract $10 from Alice’s account. If someone sees the status of the&nbsp;<code>accounts</code>&nbsp;database after the first update to Bob’s account but before the second update to Alice’s account, they could get an incorrect understanding of the total amount of money held by the bank.</li>
</ul>
</li>
</ul></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Transactions](https://cs50.harvard.edu/sql/2024/notes/5/#transactions)" dir="auto" class="heading" id="[Transactions](https://cs50.harvard.edu/sql/2024/notes/5/#transactions)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" target="_blank">Transactions</a></h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">To an outside observer, it should seem like the different parts of a transaction happen all at once. In database terminology, a transaction is an individual unit of work — something that cannot be broken down into smaller pieces.</li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Transactions have some properties, which can be remembered using the acronym ACID:
<ul>
<li data-line="2" dir="auto"><strong>atomicity</strong>: can’t be broken down into smaller pieces,</li>
<li data-line="3" dir="auto"><strong>consistency</strong>: should not violate a database constraint,</li>
<li data-line="4" dir="auto"><strong>isolation</strong>: if multiple users access a database, their transactions cannot interfere with each other,</li>
<li data-line="5" dir="auto"><strong>durability</strong>: in case of any failure within the database, all data changed by transactions will remain.</li>
</ul>
</li>
<li data-line="6" dir="auto">Let’s open up&nbsp;<code>bank.db</code>&nbsp;in our terminal so we can implement a transaction for transferring money from Alice to Bob!</li>
<li data-line="7" dir="auto">First, we want to see the data already in the&nbsp;<code>accounts</code>&nbsp;table.
<pre><code data-line="9">SELECT * FROM "accounts";
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
  We note here that Bob’s ID is 2 and Alice’s ID is 1, which will be useful for our query.<br>
</li>
<li data-line="15" dir="auto">To move $10 from Alice’s account to Bob’s, we can write the following transaction.
<pre><code data-line="17">BEGIN TRANSACTION;
UPDATE "accounts" SET "balance" = "balance" + 10 WHERE "id" = 2;
UPDATE "accounts" SET "balance" = "balance" - 10 WHERE "id" = 1;
COMMIT;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
  Notice the&nbsp;<code>UPDATE</code>&nbsp;statements are written in between the commands to begin the transaction and to commit it. If we execute the query after writing the&nbsp;<code>UPDATE</code>&nbsp;statements, but without committing, neither of the two&nbsp;<code>UPDATE</code>&nbsp;statements will be run! This helps keep the transaction&nbsp;<strong>atomic</strong>. By updating our table in this way, we are unable to see the intermediate steps.<br>
</li>
<li data-line="26" dir="auto">If we tried to run the above transaction again — Alice tries to pay Bob another $10 — it should fail to run because Alice’s account balance is at 0. (The&nbsp;<code>"balance"</code>&nbsp;column in&nbsp;<code>accounts</code>&nbsp;has a check constraint to ensure that it has a non-negative value. We can run&nbsp;<code>.schema</code>&nbsp;to check this.)</li>
<li data-line="27" dir="auto">The way we implement reverting the transaction is using&nbsp;<code>ROLLBACK</code>. Once we begin a transaction and write some SQL statements, if any of them fail, we can end it with a&nbsp;<code>ROLLBACK</code>&nbsp;to revert all values to their pre-transaction state. This helps keep transactions&nbsp;<strong>consistent</strong>.
<pre><code data-line="29">BEGIN TRANSACTION;
UPDATE "accounts" SET "balance" = "balance" + 10 WHERE "id" = 2;
UPDATE "accounts" SET "balance" = "balance" - 10 WHERE "id" = 1; -- Invokes constraint error
ROLLBACK;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Race Conditions](https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions)" dir="auto" class="heading" id="[Race_Conditions](https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" target="_blank">Race Conditions</a></h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Transactions can help guard against race conditions.</li>
<li data-line="1" dir="auto">A race condition occurs when multiple entities simultaneously access and make decisions based on a shared value, potentially causing inconsistencies in the database. Unresolved race conditions can be exploited by hackers to manipulate the database.</li>
<li data-line="2" dir="auto">In the lecture, an example of a race condition is discussed wherein two users working together can exploit momentary inconsistencies in the database to rob the bank.</li>
<li data-line="3" dir="auto">However, transactions are processed in&nbsp;<strong>isolation</strong>&nbsp;to avoid the inconsistencies in the first place. Each transaction dealing with similar data from our database will be processed sequentially. This helps prevent the inconsistencies that an adversarial attack can exploit.</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>To make transactions sequential, SQLite and other database management systems use&nbsp;<strong>locks</strong>&nbsp;on databases. A table in a database could be in a few different states:
<ul>
<li data-line="5" dir="auto"><strong>UNLOCKED</strong>: this is the default state when no user is accessing the database,</li>
<li data-line="6" dir="auto"><strong>SHARED</strong>: when a transaction is reading data from the database, it obtains shared lock that allows other transactions to read simultaneously from the database,</li>
<li data-line="7" dir="auto"><strong>EXCLUSIVE</strong>: if a transaction needs to write or update data, it obtains an exclusive lock on the database that does not allow other transactions to occur at the same time (not even a read)</li>
</ul>
</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-3)" dir="auto" class="heading" id="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-3)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" target="_blank">Questions</a></h3><div class="heading-children"><div class="el-blockquote"><blockquote dir="auto">
<p>How do we decide when a transaction can get an exclusive lock? How do we prioritize different kinds of transactions?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Different algorithms could be used to make these decisions. For example, we could always choose the transaction that came first. If an exclusive transaction is needed, no other transaction can run at the same time, which is a necessary downside to ensure consistency of the table.</li>
</ul></div><div class="el-blockquote"><blockquote dir="auto">
<p>What is the granularity of locking? Do we lock a database, a table or a row of a table?</p>
</blockquote></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">This depends on the DBMS. In SQLite, we can actually do this by running an exclusive transaction as below:
<pre><code data-line="2">BEGIN EXCLUSIVE TRANSACTION;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
  If we do not complete this transaction now, and try to connect to the database through a different terminal to read from the table, we will get an error that the database is locked! This, of course, is a very coarse way of locking because it locks the entire database. Because SQLite is coarse in this manner, it has a module for prioritizing transactions and making sure an exclusive lock is obtained only for the shortest necessary duration.<br>
</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="[Fin](https://cs50.harvard.edu/sql/2024/notes/5/#fin)" dir="auto" class="heading" id="[Fin](https://cs50.harvard.edu/sql/2024/notes/5/#fin)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#fin" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#fin" target="_blank">Fin</a></h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">This brings us to the conclusion of Lecture 5 about Optimizing in SQL!</li>
</ul></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#<a data-tooltip-position=&quot;top&quot; aria-label=&quot;https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5&quot; rel=&quot;noopener nofollow&quot; class=&quot;external-link&quot; href=&quot;https://cs50.harvard.edu/sql/2024/notes/5/#lecture-5&quot; target=&quot;_blank&quot;>Lecture 5</a>"><div class="tree-item-contents heading-link" heading-name="Lecture 5"><span class="tree-item-title">Lecture 5</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Introduction](https://cs50.harvard.edu/sql/2024/notes/5/#introduction)"><div class="tree-item-contents heading-link" heading-name="[Introduction](https://cs50.harvard.edu/sql/2024/notes/5/#introduction)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#introduction" target="_blank">Introduction</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Index](https://cs50.harvard.edu/sql/2024/notes/5/#index)"><div class="tree-item-contents heading-link" heading-name="[Index](https://cs50.harvard.edu/sql/2024/notes/5/#index)"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index" target="_blank">Index</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions)"><div class="tree-item-contents heading-link" heading-name="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions" target="_blank">Questions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Index_across_Multiple_Tables](https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables)"><div class="tree-item-contents heading-link" heading-name="[Index across Multiple Tables](https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#index-across-multiple-tables" target="_blank">Index across Multiple Tables</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Space_Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off)"><div class="tree-item-contents heading-link" heading-name="[Space Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#space-trade-off" target="_blank">Space Trade-off</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Time_Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off)"><div class="tree-item-contents heading-link" heading-name="[Time Trade-off](https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#time-trade-off" target="_blank">Time Trade-off</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Partial_Index](https://cs50.harvard.edu/sql/2024/notes/5/#partial-index)"><div class="tree-item-contents heading-link" heading-name="[Partial Index](https://cs50.harvard.edu/sql/2024/notes/5/#partial-index)"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#partial-index" target="_blank">Partial Index</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-1)"><div class="tree-item-contents heading-link" heading-name="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-1)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-1" target="_blank">Questions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Vacuum](https://cs50.harvard.edu/sql/2024/notes/5/#vacuum)"><div class="tree-item-contents heading-link" heading-name="[Vacuum](https://cs50.harvard.edu/sql/2024/notes/5/#vacuum)"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#vacuum" target="_blank">Vacuum</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-2)"><div class="tree-item-contents heading-link" heading-name="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-2)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-2" target="_blank">Questions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Concurrency](https://cs50.harvard.edu/sql/2024/notes/5/#concurrency)"><div class="tree-item-contents heading-link" heading-name="[Concurrency](https://cs50.harvard.edu/sql/2024/notes/5/#concurrency)"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#concurrency" target="_blank">Concurrency</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Transactions](https://cs50.harvard.edu/sql/2024/notes/5/#transactions)"><div class="tree-item-contents heading-link" heading-name="[Transactions](https://cs50.harvard.edu/sql/2024/notes/5/#transactions)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#transactions" target="_blank">Transactions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Race_Conditions](https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions)"><div class="tree-item-contents heading-link" heading-name="[Race Conditions](https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#race-conditions" target="_blank">Race Conditions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-3)"><div class="tree-item-contents heading-link" heading-name="[Questions](https://cs50.harvard.edu/sql/2024/notes/5/#questions-3)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#questions-3" target="_blank">Questions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="cs50-sql\lecture-5-optimizing-(nc).html#[Fin](https://cs50.harvard.edu/sql/2024/notes/5/#fin)"><div class="tree-item-contents heading-link" heading-name="[Fin](https://cs50.harvard.edu/sql/2024/notes/5/#fin)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://cs50.harvard.edu/sql/2024/notes/5/#fin" rel="noopener nofollow" class="external-link" href="https://cs50.harvard.edu/sql/2024/notes/5/#fin" target="_blank">Fin</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>